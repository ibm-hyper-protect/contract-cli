# Contract CLI

[![contract-cli CI](https://github.com/ibm-hyper-protect/contract-cli/actions/workflows/build.yaml/badge.svg)](https://github.com/ibm-hyper-protect/contract-cli/actions/workflows/build.yaml)
[![Latest Release](https://img.shields.io/github/v/release/ibm-hyper-protect/contract-cli?include_prereleases)](https://github.com/ibm-hyper-protect/contract-cli/releases/latest)
[![Go Report Card](https://goreportcard.com/badge/github.com/ibm-hyper-protect/contract-cli)](https://goreportcard.com/report/ibm-hyper-protect/contract-cli)
[![GitHub All Releases](https://img.shields.io/github/downloads/ibm-hyper-protect/contract-cli/total.svg)](https://github.com/ibm-hyper-protect/contract-cli/releases/latest)

## Introduction

The CLI tool has been developed to automate the process of provisioning Hyper Protect Virtual Servers (HPVS) and Hyper Protect Container Runtime for RedHat Virtualization Solutions (HPCR RHVS). This CLI tool leverages [ibm-hyper-protect/contract-go](https://github.com/ibm-hyper-protect/contract-go) for all the features.

To download the CLI tool for your respective OS, please refer the [release page](https://github.com/ibm-hyper-protect/contract-cli/releases). 

For more details on Hyper Protect Virtual Servers for VPC and Hyper Protect Container Runtime, refer [Confidential computing with LinuxONE](https://cloud.ibm.com/docs/vpc?topic=vpc-about-se) and [IBM Hyper Protect Virtual Servers](https://www.ibm.com/docs/en/hpvs/2.2.x).

## Usage

```bash
$ contract-cli --help
This tool helps to provision HPVS/RHVS on IBM Cloud and On Prem 

Refer github.com/ibm-hyper-protect/contract-cli for details on features

Usage:
  contract-cli [command]

Available Commands:
  base64               Generate base64 of input
  base64-tgz           Generate base64 tar.tgz of docker-compose.yaml or pods.yaml
  decrypt-attestation  Decrypt encrypted attestation records
  download-certificate Download encryption certificate
  encrypt              Generate signed and encrypted contract
  encrypt-string       Encrypt string as per Hyper Protect format
  get-certificate      Get version specific encryption certificate from download-certificate JSON ouput
  help                 Help about any command
  image                Get latest HPCR Image ID from IBM Cloud Image list
  validate-contract    Validate unencrypted contract
  validate-network     Validate schema of network-config

Flags:
  -h, --help   help for contract-cli

Use "contract-cli [command] --help" for more information about a command.
```

## Features

1. Generate Base64 or plain text or JSON input.
2. Generate Base64 tar.tgz of `docker-compose.yaml` or `pods.yaml`.
3. Decrypt encrypted attestation records generated by HPVS instance.
4. Download encryption certificates from HPVS download portal.
5. Select encryption certificate from JSON of encryption certificates downloaded from HPVS download portal.
6. Encrypt plain text or JSON data as per Hyper Protect format.
7. Generate signed and encrypted contract for HPVS (with and without contract expiry).
8. Get the image details of any available (default to latest) HPVS image in IBM Cloud.
9. Validate unencrypted contracts for provisioning in HPVS.
10. Validate schema of network-config (for on-prem environment) for HPVS and HPCR RHVS.

## Documentation

Refer [Docs](docs/README.md) for more details on how to leverage this CLI for your usecases.

## References

- [contract-go](https://github.com/ibm-hyper-protect/contract-go) - Go Library for generating Hyper Protect contracts
- [terraform-provider-hpcr](https://github.com/ibm-hyper-protect/terraform-provider-hpcr) - Terraform Provider for generating Hyper Protect contracts
- [k8s-operator-hpcr](https://github.com/ibm-hyper-protect/k8s-operator-hpcr) - Kubernetes operator for generating Hyper Protect contracts
- [linuxone-vsi-automation-samples - hpvs](https://github.com/ibm-hyper-protect/linuxone-vsi-automation-samples/tree/master/terraform-hpvs) - Terraform examples to provision HPVS
- [linuxone-vsi-automation-samples - hpcr-rhvs](https://github.com/ibm-hyper-protect/linuxone-vsi-automation-samples/tree/master/terraform-hpcr-rhvs) - Terraform examples to provision HPCR RHVS
- [hyper-protect-virtual-server-samples](https://github.com/ibm-hyper-protect/hyper-protect-virtual-server-samples) - HPVS scripts for different features

## Contributors

![Contributors](https://contrib.rocks/image?repo=ibm-hyper-protect/contract-cli)
