// Copyright (c) 2025 IBM Corp.
// All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

package common

const (
	ContractCliName             = "contract-cli"
	ContractCliShortDescription = "A CLI tool for managing IBM Hyper Protect contracts and configurations"
	ContractCliLongDescription  = `Contract CLI automates contract generation and management for IBM Hyper Protect services.

Supports:
  - Hyper Protect Virtual Servers (HPVS) for VPC
  - Hyper Protect Container Runtime (HPCR) for RHVS
  - Hyper Protect Confidential Container (HPCC) Peer Pods

Documentation: https://github.com/ibm-hyper-protect/contract-cli/blob/main/docs/README.md`

	// Common

	FileInFlagName  = "in"
	FileOutFlagName = "out"

	DataFormatFlagName        = "format"
	DataFormatDefault         = "json"
	DataFormatJson            = "json"
	DataFormatYaml            = "yaml"
	DataFormatText            = "text"
	DataFormatFlagDescription = "Output format for data (json, yaml, or text)"

	PrivateKeyFlagName        = "priv"
	PrivateKeyFlagDescription = "Path to private key file for signing"

	CertFlagName        = "cert"
	CertFlagDescription = "Path to encryption certificate file"

	OsVersionFlagName        = "os"
	OsVersionFlagDescription = "Target Hyper Protect platform (hpvs, hpcr-rhvs, or hpcc-peerpod)"

	VersionFlagName = "version"

	// Decrypt Attestation Records
	DecryptAttestParamName             = "decrypt-attestation"
	DecryptAttestParamShortDescription = "Decrypt encrypted attestation records"
	DecryptAttestParamLongDescription  = `Decrypt encrypted attestation records generated by Hyper Protect instances.

Attestation records are typically found at /var/hyperprotect/se-checksums.txt.enc
and contain cryptographic hashes for verifying workload integrity.`
	DecryptAttestFileInDefaultPath = "build/se-checksums.txt.enc"
	DecryptAttestFileInDescription = "Path to encrypted attestation file (se-checksums.txt.enc)"
	DecryptAttestFlagDescription   = "Path to save decrypted attestation records"

	// Get latest HPVS Image ID
	ImageParamName             = "image"
	ImageParamShortDescription = "Get HPCR image details from IBM Cloud"
	ImageParamLongDescription  = `Retrieve Hyper Protect Container Runtime (HPCR) image details from IBM Cloud.

Parses image information from IBM Cloud API, CLI, or Terraform output to extract
image ID, name, checksum, and version. Supports filtering by specific HPCR version.`
	IbmCloudJsonInputDescription = "Path to IBM Cloud images JSON (from API, CLI, or Terraform)"
	HpcrVersionFlagDescription   = "Specific HPCR version to retrieve (returns latest if not specified)"
	HpcrImageFlagDescription     = "Path to save HPCR image details"

	// Download Encryption certificates
	DownloadCertParamName             = "download-certificate"
	DownloadCertParamShortDescription = "Download encryption certificates"
	DownloadCertParamLongDescription  = `Download encryption certificates from the IBM Hyper Protect Repository.

Retrieves the latest or specific versions of HPCR encryption certificates required
for contract encryption and workload deployment.`
	EncryptionCertVersionFlagDescription = "Specific certificate versions to download (comma-separated, e.g., 1.0.21,1.0.22)"
	EncryptionCertsFlagDescription       = "Path to save downloaded encryption certificates"

	// Get Encryption Certificate
	GetCertParamName             = "get-certificate"
	GetCertParamShortDescription = "Extract specific certificate version from download output"
	GetCertParamLongDescription  = `Extract a specific encryption certificate version from download-certificate output.

Parses the JSON output from download-certificate and extracts the certificate
for the specified version.`
	GetCertFileInFlagDescription  = "Path to download-certificate JSON output"
	GetCertVersionFlagDescription = "Certificate version to extract (e.g., 1.0.23)"
	GetCertFileOutFlagDescription = "Path to save extracted encryption certificate"

	// Base64
	Base64ParamName             = "base64"
	Base64ParamShortDescription = "Encode input as Base64"
	Base64ParamLongDescription  = `Encode text or JSON data to Base64 format.

Useful for encoding data that needs to be included in contracts or configurations.`
	Base64InputFlagDescription       = "Input data to encode (text or JSON)"
	Base64InputFormatFlagDescription = "Input data format (text or json)"
	Base64OutputPathFlagDescription  = "Path to save Base64 encoded output"

	// Encrypt String
	EncryptStrParamName             = "encrypt-string"
	EncryptStrParamShortDescription = "Encrypt string in Hyper Protect format"
	EncryptStrParamLongDescription  = `Encrypt strings using the Hyper Protect encryption format.

Output format: hyper-protect-basic.<encrypted-password>.<encrypted-string>
Use this to encrypt sensitive data like passwords or API keys for contracts.`
	EncryptStrInputFlagDescription  = "String data to encrypt (text or JSON)"
	EncryptStrFormatFlagDescription = "Input data format (text or json)"
	EncryptStrOutputFlagDescription = "Path to save encrypted output"

	// Base64 tar
	Base64TgzParamName             = "base64-tgz"
	Base64TgzParamShortDescription = "Create Base64 tar archive of container configurations"
	Base64TgzParamLongDescription  = `Generate Base64-encoded tar.gz archive of docker-compose.yaml or pods.yaml.

Creates a compressed archive of your container configuration files, encoded as Base64
for inclusion in Hyper Protect contracts. Supports both plain and encrypted output.`
	Base64TgzInputFlagDescription        = "Path to folder containing docker-compose.yaml or pods.yaml"
	Base64TgzOutputFormatFlagName        = "output"
	Base64TgzOutputFormatFlagDescription = "Output format (plain or encrypted)"
	Base64TgzOutputFormatUnencrypted     = "plain"
	Base64TgzOutputFormatencrypted       = "encrypt"
	Base64TgzOutputFormatDefault         = Base64TgzOutputFormatUnencrypted
	Base64TgzOutputPathDescription       = "Path to save Base64 tar.gz output"

	// Validate contract
	ValidateContractParamName             = "validate-contract"
	ValidateContractParamShortDescription = "Validate contract schema"
	ValidateContractParamLongDescription  = `Validate an unencrypted contract against the Hyper Protect schema.

Checks contract structure, required fields, and data types before encryption.
Helps catch errors early in the development process.`
	ValidateContractInputFlagDescription = "Path to unencrypted Hyper Protect contract YAML file"

	// Signed and Encrypted Contract (With contract expiry)
	EncryptParamName             = "encrypt"
	EncryptParamShortDescription = "Generate signed and encrypted contract"
	EncryptParamLongDescription  = `Generate a signed and encrypted contract for Hyper Protect deployment.

Creates a cryptographically signed contract using your private key and encrypts it
with the platform's encryption certificate. Supports optional contract expiry for
enhanced security.`
	EncryptInputFlagDescription          = "Path to unencrypted contract YAML file"
	EncryptOutputFlagDescription         = "Path to save signed and encrypted contract"
	EncryptContractExpiryFlagName        = "contract-expiry"
	EncryptContractExpiryFlagDefault     = false
	EncryptContractExpiryFlagDescription = "Enable contract expiry feature (requires CA cert and key)"
	EncryptCaCertFlagName                = "cacert"
	EncryptCaCertFlagDescription         = "Path to CA certificate file (required with --contract-expiry)"
	EncryptCaKeyFlagName                 = "cakey"
	EncryptCaKeyFlagDescription          = "Path to CA private key file (required with --contract-expiry)"
	EncryptCsrDataFlagName               = "csrParam"
	EncryptCsrDataFlagDescription        = "Path to CSR parameters JSON file"
	EncryptCsrFlagName                   = "csr"
	EncryptCsrFlagDescription            = "Path to Certificate Signing Request (CSR) file"
	EncryptExpiryDaysFlagName            = "expiry"
	EncryptExpiryDaysFlagDescription     = "Contract validity period in days (required with --contract-expiry)"

	// Validate network-config
	ValidateNetworkConfigParamName             = "validate-network"
	ValidateNetworkConfigParamShortDescription = "Validate network configuration schema"
	ValidateNetworkConfigParamLongDescription  = `Validate network-config YAML file against the schema.

Validates network configuration for on-premise deployments, ensuring all required
fields are present and properly formatted.`
	ValidateNetworkConfigInputFlagDescription = "Path to network-config YAML file"

	// Validate Encryption certificates
	ValidateEncryptionCertParamName             = "validate-encryption-certificate"
	ValidateEncryptionCertParamShortDescription = "validate encryption certificate"
	ValidateEncryptionCertParamLongDescription  = `validate encryption certificate for HPCR from IBM Hyper Protect Repository

Validates encryption certificate for on-premise, VPC deployment.
It will check encryption certificate validity`
	ValidateEncryptionCertVersionFlagDescription = "Versions of Encryption Certificates to validate, Seperated by coma(,)"
)
